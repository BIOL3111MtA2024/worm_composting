---
title: "WormDataImport"
date: "`r format(Sys.Date())`"
author:
- Georgia Pardy^1^*
- Sylwia^1^*
- Rajan^1^*
- Douglas Campbell^1^*
- Carlie Barnhill^1^*
output:
  bookdown::html_document2:
    code_folding: show
    keep_md: yes
    toc: TRUE
    toc_float: TRUE
    toc_depth: 6
    fig_caption: yes
bibliography: RPackageCitations.bib
csl: plos-one.csl
editor_options: 
  markdown: 
    wrap: 72
---
```{css, echo=FALSE}
p.caption {
  font-size: 18px;
}
```


# Affiliations {-}
^1^Mount Allison University, New Brunswick, Canada  

*corresponding author  

# Acknowledgements {-}
Brackets minus after heading excludes heading from numbering.
DAC was supported by the Canada Research Chairs.

# Overview
File import functions read files into R objects, commonly data frames. 

# Materials & Methods  
## Set chunk options
Formatted display of content from .md file on GitHub site.
Upon knitr figures will be saved to 'Figs/'
```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, error = FALSE, message = FALSE)
knitr::opts_chunk$set(fig.path='Figs/')
```

## Load packages
```{r packages, include = FALSE}
library(tidyverse) #core packages from Tidyverse
library(googledrive) #access to GoogleDrive
library(googlesheets4) #access to GoogleSheets
library(lubridate) #tidyverse handling dates & times
```

## InLine Citations of software packages added through the 'citr' option under 'Addins'.  
The cited items must be in the .bib file saved in the .Rproj folder; in this case RPackageCitations.bib, generated by exporting a library to .bib from Zotero.  Upon export click the 'Keep Updated' button in the BetterBibTex menu.  If new citations are added to Zotero they will be pushed through to update the exported .bib file in the .Rproj folder.
[@bryanGooglesheets4AccessGoogle2021;@mcgowanGoogledriveInterfaceGoogle2020; @wickhamTidyverseEasilyInstall2017]

## Source locally saved functions stored in a text file
A text file of functions is a preliminary step towards a package, to re-use functions without repasting them.

## Set Project Variables  
Try to set all user-defined variables near top of .Rmd, in one place, to avoid or limit editing of downstream code.
Assigning project-specific values to generic variables helps with re-use of code.
```{r set variables}
DataIn <- "XXXX"
TargetFile <- "YYYY"
  
```


# Import Data from a GoogleSheet
Data in a GoogleSheet is more generic than a project-specific .csv edited and saved locally and pushed to GitHub.
The GoogleSheet package interface can be tricky.
Repeatedly reading from GoogleDrive can provoke a throttle from Google.


# Connect to google account
Deauthorize google account to allow universal access to the raw data sheet.Then retrieve data sheet from where it's stored on google drive.
```{r connect_google}
#Instead of sending a token, googlesheets4 will send an API key. This can be used to access public resources for which no Google sign-in is required. 
googlesheets4::gs4_deauth()

#URL or ID of a GoogleSheet readable by anyone (with a link)
googlesheet_url <- "https://docs.google.com/spreadsheets/d/1VpTn7voQ0889RoEloQtZFyVJyPMIRbACklrrquOiC7c/edit?usp=sharing"
```


# Accessing sheets
```{r accessing_sheets}
PhysChemL <- read_sheet(googlesheet_url, sheet = "PhysChemL")

```

```{r colony_explore_filter_treatment5}
PhysChemL |>
  filter(Treatment != 5) |>
  ggplot() +
  geom_histogram(aes(Colony_Type)) +
  facet_grid(rows = vars(Treatment)) +
  theme_bw() +
  labs(
    title = "Colony Type Across Treatments in Compost Liquid"
  )
```
```{r colony_explore}
PhysChemL |>
  ggplot() +
  geom_histogram(aes(Colony_Type)) +
  facet_grid(rows = vars(Treatment)) +
  theme_bw() +
  labs(
    title = "Colony Type Across Treatments in Compost Liquid"
  )
```
This graph shows us the amount of times specefic colonies appeared on diffrent plate (we had a hard time anylizing 5 because of the fungus)
```{r Shape_explore}
PhysChemL |>
  filter(Treatment != 5) |>
  ggplot() +
  geom_histogram(aes(Shape), stat="count") +
  facet_grid(rows = vars(Treatment)) +
  theme_bw()+
  labs(
    title = "Colony Shapes Across Treatments in Compost Liquid"
  )
```
This graph shows us the different shapes of bacteria in each treatment

```{r Size_Shape_explore}
PhysChemL |>
  filter(Treatment != 5) |>
  ggplot() +
  geom_histogram(aes(Size_um)) +
  facet_grid(rows = vars(Treatment), cols = vars(Shape)) +
  theme_bw() +
  labs(
    title = "Colony Size Across Different Shapes and Treatments in Compost Liquid"
  )
```
```{r Size_explore}
PhysChemL |>
  ggplot() +
  geom_histogram(aes(Size_um)) +
  facet_grid(rows = vars(Treatment)) +
  theme_bw() +
  labs(
    title = "Colony Size Across Treatments in Compost Liquid"
  )
```
```{r Plate_Colony_explore}
PhysChemL |>
  ggplot() +
  geom_histogram(aes(Plate_Colony)) +
  facet_grid(rows = vars(Treatment)) +
  theme_bw() 
```
This graph shows how many colonies were taken from each plate, and how many bacteria types were in each colony (liquid)

```{r Size_Gram_explore}
PhysChemL |>
  ggplot() +
  geom_histogram(aes(Gram)) +
  facet_grid(rows = vars(Treatment), cols = vars(Shape)) +
  theme_bw() +
  labs(
    title = "Colony Gram Across Treatments and Shapes in Compost Liquid "
  )
```
```{r Gram_explore}
PhysChemL |>
  ggplot() +
  geom_histogram(aes(Gram)) +
  facet_grid(rows = vars(Treatment)) +
  theme_bw() +
  labs(
    title = "Colony Gram Across Treatments of Compost Pallet "
  )
```
```{r Gram_ColonyType_explore}
## scale_x_continuous(breaks = c(a,b)) : in which set x-axis to display specific numbers value
PhysChemL |>
  ggplot() +
  geom_histogram(aes(Gram)) +
  facet_grid(rows = vars(Treatment), cols = vars(Colony_Type)) +
  scale_x_continuous(breaks = c(0, 1)) +
  theme_bw()+
  labs(
    title = "Colony Gram Across Treatments and Colony Types of Compost Liquid"
  )
```
This graph shows us the different gram stains across colonies in the treatment types, which let us see if the colonoes have consistent gram types across treatments. If they don't, they were likely different colonies. 

This next section is loking at the biodiversity of the worm pellets. (PhysChem2) We overall have lestt infprmation for shis, but puting the graphs side by side during a presentation could be helpful
```{r}
PhysChemP <- read_sheet(googlesheet_url, sheet = "PhysChemP")
```
Colony type per treatment is really the only thing we can do here, see data dictionary for description
```{r ColonyType_explore}
# add , fill = "#7bbea5" if want color
PhysChemP |>
  ggplot() +
  geom_histogram(aes(Colony_Type)) +
  facet_grid(rows = vars(Treatment)) +
  theme_bw() +
  labs(
    title = "Colony Types Across Treatments of Compost Pallet "
  )
```

This graph shows the comparyision between colony types across treatments. The 'Count' shows the frequency that type appears
```{r liquid_pallet_comparasion}
# Combine two dataframe
PhysChem_combined <- bind_rows(
  PhysChemP %>% mutate(Source = "Pallet"),
  PhysChemL %>% mutate(Source = "Liquid")
)

# Plot the data
  ## scale_fill_brewer(palette = "______"): set color for the graph
  ## position = "dodge" : put the columns side-by-side
  ## binwidth = ____ : changing size of the columns
ggplot(PhysChem_combined) +
  geom_histogram(aes(x = Colony_Type, fill = Source), position = "dodge", binwidth = 1) +
  facet_grid(rows = vars(Treatment)) +
  theme_bw() +
  scale_fill_brewer(palette = "Set2") +
  labs(
    title = "Comparison of Colony Types between Compost Pallet and Liquid ",
    x = "Colony_Type",
    y = "Count",
    fill = "Figure"
  )
```

# Bibliography
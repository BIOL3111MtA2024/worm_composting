---
title: "WormDataImport"
date: "`r format(Sys.Date())`"
author:
- Georgia Pardy^1^*
- Sylwia^1^*
- Rajan^1^*
- Douglas Campbell^1^*
- Carlie Barnhill^1^*
output:
  bookdown::html_document2:
    code_folding: show
    keep_md: yes
    toc: TRUE
    toc_float: TRUE
    toc_depth: 6
    fig_caption: yes
bibliography: RPackageCitations.bib
csl: plos-one.csl
editor_options: 
  markdown: 
    wrap: 72
---
```{css, echo=FALSE}
p.caption {
  font-size: 18px;
}
```


# Affiliations {-}
^1^Mount Allison University, New Brunswick, Canada  

*corresponding author  

# Acknowledgements {-}
Brackets minus after heading excludes heading from numbering.
DAC was supported by the Canada Research Chairs.

# Overview
File import functions read files into R objects, commonly data frames. 

# Materials & Methods  
## Set chunk options
Formatted display of content from .md file on GitHub site.
Upon knitr figures will be saved to 'Figs/'
```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, error = FALSE, message = FALSE)
knitr::opts_chunk$set(fig.path='Figs/')
```

## Load packages
```{r packages, include = FALSE}
library(tidyverse) #core packages from Tidyverse
library(googledrive) #access to GoogleDrive
library(googlesheets4) #access to GoogleSheets
library(lubridate) #tidyverse handling dates & times
```

## InLine Citations of software packages added through the 'citr' option under 'Addins'.  
The cited items must be in the .bib file saved in the .Rproj folder; in this case RPackageCitations.bib, generated by exporting a library to .bib from Zotero.  Upon export click the 'Keep Updated' button in the BetterBibTex menu.  If new citations are added to Zotero they will be pushed through to update the exported .bib file in the .Rproj folder.
[@bryanGooglesheets4AccessGoogle2021;@mcgowanGoogledriveInterfaceGoogle2020; @wickhamTidyverseEasilyInstall2017]

## Source locally saved functions stored in a text file
A text file of functions is a preliminary step towards a package, to re-use functions without repasting them.

## Set Project Variables  
Try to set all user-defined variables near top of .Rmd, in one place, to avoid or limit editing of downstream code.
Assigning project-specific values to generic variables helps with re-use of code.
```{r set variables}
DataIn <- "XXXX"
TargetFile <- "YYYY"
  
```


# Import Data from a GoogleSheet
Data in a GoogleSheet is more generic than a project-specific .csv edited and saved locally and pushed to GitHub.
The GoogleSheet package interface can be tricky.
Repeatedly reading from GoogleDrive can provoke a throttle from Google.


# Connect to google account
Deauthorize google account to allow universal access to the raw data sheet.Then retrieve data sheet from where it's stored on google drive.
```{r connect_google}
#Instead of sending a token, googlesheets4 will send an API key. This can be used to access public resources for which no Google sign-in is required. 
googlesheets4::gs4_deauth()

#URL or ID of a GoogleSheet readable by anyone (with a link)
googlesheet_url <- "https://docs.google.com/spreadsheets/d/1VpTn7voQ0889RoEloQtZFyVJyPMIRbACklrrquOiC7c/edit?usp=sharing"
```


# Accessing sheets
```{r accessing_sheets}
PhysChem <- read_sheet(googlesheet_url, sheet = "PhysChem")

```

```{r colony_explore}
PhysChem |>
  filter(Treatment != 5) |>
  ggplot() +
  geom_histogram(aes(Colony_Type)) +
  facet_grid(rows = vars(Treatment)) +
  theme_bw()
```

```{r Shape_explore}
PhysChem |>
  filter(Treatment != 5) |>
  ggplot() +
  geom_histogram(aes(Shape), stat="count") +
  facet_grid(rows = vars(Treatment)) +
  theme_bw()
```


```{r Size_explore}
PhysChem |>
  filter(Treatment != 5) |>
  ggplot() +
  geom_histogram(aes(Size_um)) +
  facet_grid(rows = vars(Treatment), cols = vars(Shape)) +
  theme_bw()
```

# Bibliography